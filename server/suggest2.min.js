var mporan_suggest2={loadSuggestions:function(){var e,t=this.action.ajaxIdentifier,s=!1,i=this.action.attribute01,n="suggest-"+i,a="#"+i,o=this.action.attribute02,g=Boolean("Y"==this.action.attribute03),u=Boolean("Y"==this.action.attribute05),d=Boolean("Y"==this.action.attribute08),p=this.action.attribute09,l=this.action.attribute10,c=$(a).data("select2");apex.debug("affectedElementId "+i),c.on("results:message",function(e){mporan_suggest2.fixGap(c)}),$("body").on("select2:open",a,function(t){if(apex.debug("select2:open"),!$("#"+n).length){var a='<div class="suggest__menu" id="'+n+'">'+(l=null!==l?'<div class="suggest__custom-html">'+l+"</div>":"")+'<div class="suggest__options"></div></div>';$("#select2-"+i+"-results").parents(".select2-dropdown").append(a)}s?mporan_suggest2.displayResult(n,e):!$(".suggest__loading").length&&g&&$("#"+n).append('<div class="suggest__header suggest__loading">Loading suggestions...</div>'),$("#"+n).show(),$(".suggest__option--selected i").show(),$(".suggest__option").removeClass("suggest__option--selected"),$(".select2-container").off("keyup",".select2-search__field").on("keyup",".select2-search__field",function(){apex.debug("toggleMenuKeyup"),$(this).val().length>0&&$(".suggest__menu").is(":visible")&&$(".suggest__menu").hide(),0==$(this).val().length&&$(".suggest__menu").show(),mporan_suggest2.fixGap(c)})}),g&&apex.server.plugin(t,{x01:"DRAW"},{dataType:"json",success:function(g){if(s=!0,apex.debug("finishedFetch "+s+"  "+n+"  "+g),g.length>0){e='<div class="suggest__header">'+o,u&&(e+="<i>Remove All</i>"),e+="</div>";var l="";for(var c in p&&(l='<span class="fa '+p+'" aria-hidden="true"></span>'),g)e+='<a href="javascript:void(0);" class="suggest__option " data-id="'+g[c][1]+'">'+l+g[c][0],u&&(e+="<i>Remove</i>"),e+="</a>";e+="</div>",$("body").on("click","#"+n+" .suggest__option",function(){event.preventDefault();var e=$(this).clone();e.find("i").remove();var t=e.text(),s=$(this).data("id");$(a+" option").each(function(){$(this).val()==s&&($(this).remove(),apex.debug("Removed existing option"))});var i=new Option(t,s);i.selected=!0,$(a).append(i),$(a).trigger("change"),d?($(this).addClass("suggest__option--selected"),$(this).children("i").hide()):$(a).select2("close")}),u&&mporan_suggest2.deleteItem(i,t)}$("#"+n).length>0&&mporan_suggest2.displayResult(n,e)}})},fixGap:function(e){apex.debug("fixGap"),e.dropdown._resizeDropdown(),e.dropdown._positionDropdown()},displayResult:function(e,t){$("#"+e+" .suggest__option").length||(t?(apex.debug("appending"),$(".suggest__loading").remove(),$("#"+e+" .suggest__options").append(t)):$("#"+e+" .suggest__options").remove())},deleteItem:function(e,t){apex.debug("function deleteItem "+s);var s="suggest-"+e,i=$("#"+e).data("select2");$("body").on("click","#"+s+" .suggest__option i",function(e){e.stopPropagation();var n=$(this).parent().data("id");apex.debug("deleteItem "+n),apex.server.plugin(t,{x01:"DELETE",x02:n},{dataType:"text",success:function(e){apex.debug("Deleted Single")}}),$(this).parent().remove(),0==$("#"+s+" .suggest__option").length&&$(".suggest__options").hide(),mporan_suggest2.fixGap(i)}),$("body").on("click","#"+s+" .suggest__header i",function(e){e.stopPropagation(),apex.debug("Delete All"),apex.server.plugin(t,{x01:"DELETE_ALL"},{dataType:"text",success:function(e){apex.debug("Deleted All")}}),$(".suggest__options").hide(),mporan_suggest2.fixGap(i)})}};
